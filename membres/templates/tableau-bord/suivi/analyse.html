{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="icon" href="{% static 'images/Logo EcoNova.png' %}">
    <link rel="stylesheet" href="{% static 'css/tableau-bord/dashboard.css' %}">
    <link rel="stylesheet" href="{% static 'css/tableau-bord/suivi/analyse.css' %}">
    <!-- animation des icones dans la barre de navigation-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bodymovin/5.12.2/lottie.min.js"></script>
    <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>

  <title>Dashboard App</title>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<!--Menu du profil (bouton en haut à droite)-->
    <lottie-player class="icon-profile" id="icon-profile" src="{% static 'json/dashboard-icon/User_custom_icon.json' %}"
                       hover></lottie-player>
    <div class="menu-profil menu-hide" id="menu-profil">
        <div class="menu-profil-section1">
            <img src="{% static 'images/dashboard-icon/profil-icon.svg' %}" alt="Icon de profil">
            <h2>
                {{ user.username }}
            </h2>
            <h3>{{ user.email }}</h3>

        </div>
        <div class="menu-profil-section2">
            <a href="profil" class="">
                <img src="{% static 'images/dashboard-icon/profil.svg' %}" alt="Icon de profil">
                <h2>Mon profil</h2>
            </a>
            <a href="/membres/static" class="">
                <img src="{% static 'images/dashboard-icon/home_24dp_E3E3E3_FILL0_wght400_GRAD0_opsz24.svg' %}"
                     style="filter: invert(100%) sepia(100%) saturate(0%) hue-rotate(180deg) brightness(100%) contrast(100%);"
                     alt="Icon page d'accueil">
                <h2>Page d'accueil</h2>
            </a>
        </div>
        <div class="menu-profil-section3">
            <a href="/deconnexion" class="">
                <img src="{% static 'images/dashboard-icon/logout-svgrepo-com 1.svg' %}" alt="Icon de déconnexion">
                <h2>Se déconnecter</h2>
            </a>
        </div>
    </div>



<!--Menu du profil (bouton en haut à droite)-->
    <lottie-player class="icon-profile" id="icon-profile" src="{% static 'json/dashboard-icon/User_custom_icon.json' %}"
                       hover></lottie-player>
    <div class="menu-profil menu-hide" id="menu-profil">
        <div class="menu-profil-section1">
            <img src="{% static 'images/dashboard-icon/profil-icon.svg' %}" alt="Icon de profil">
            <h2>
                {{ user.username }}
            </h2>
            <h3>{{ user.email }}</h3>

        </div>
        <div class="menu-profil-section2">
            <a href="profil" class="">
                <img src="{% static 'images/dashboard-icon/profil.svg' %}" alt="Icon de profil">
                <h2>Mon profil</h2>
            </a>
            <a href="/membres/static" class="">
                <img src="{% static 'images/dashboard-icon/home_24dp_E3E3E3_FILL0_wght400_GRAD0_opsz24.svg' %}"
                     style="filter: invert(100%) sepia(100%) saturate(0%) hue-rotate(180deg) brightness(100%) contrast(100%);"
                     alt="Icon page d'accueil">
                <h2>Page d'accueil</h2>
            </a>
        </div>
        <div class="menu-profil-section3">
            <a href="/deconnexion" class="">
                <img src="{% static 'images/dashboard-icon/logout-svgrepo-com 1.svg' %}" alt="Icon de déconnexion">
                <h2>Se déconnecter</h2>
            </a>
        </div>
    </div>

<!--Menu à gauche-->
    <section class="menu">
        <div class="logoSite">
          <a href="/membres/static"><img src="{% static 'images/Logo EcoNova.png' %}" alt="Logo ÉcoNova Finance"
                                         class="logoSite"></a>
          <h2 class="econova-text">EcoNova</h2>
        </div>
        <div class="onglets">
            <a href="page-principale" class="page-principale onglet">
                <lottie-player src="{% static 'json/dashboard-icon/Home_custom_icon.json' %}" hover></lottie-player>
                <h2>Page principale</h2>
            </a>
            <div class="onglet-outils onglet">
                <lottie-player src="{% static 'json/dashboard-icon/Wrench_custom_icon.json' %}" hover></lottie-player>
                <h2 class="titre-outil">Outils Financiers</h2>
                <img src="{% static 'images/dashboard-icon/triangle.svg' %}" class="triangle">
            </div>

            <div class="outils" id="outils">
                <a href="suivi" class="onglet-suivi onglet">
                    <h2>Suivi</h2>
                </a>
                <a href="bourse" class="onglet-bourse onglet">
                    <h2>Bourse</h2>
                </a>
                <a href="simulation" class="onglet-simulation onglet">
                    <h2>Simulation</h2>
                </a>
                <a href="chatbot" class="onglet-nova onglet">
                    <h2>NOVA</h2>
                </a>
            </div>
        </div>
        <a href="/education" class="onglet-dictionnaire onglet">
            <lottie-player src="{% static 'json/dashboard-icon/Arrow left_custom_icon.json' %}" hover></lottie-player>
            <h2>Éducation Financière</h2>
        </a>
    </section>

<div class="container">
    <h1>Analyse financier</h1>
    <!-- mini-graphiques pour les revenus, les dépenses et le capital de l'utilisateur -->
    <div class="section-revenu-depense">
      <div class="card mini-graphique">
        <h2>Revenues</h2>
        <canvas id="chartRevenues"></canvas>
          <hr> <!-- séparateur horizontale-->
          <h1>1000$</h1>
      </div>
      <div class="card mini-graphique">
        <h2>Valeur Nette</h2>
        <canvas id="chartValeurNette"></canvas>
          <hr>
          <h1>1000$</h1>
      </div>
      <div class="card mini-graphique">
        <h2>Dépenses</h2>
        <canvas id="chartDepenses"></canvas>
          <hr>
          <h1>1000$</h1>
      </div>
    </div>

    <!-- Main Line Chart and user-list side by side -->
    <div class="objectifs-dettes">
      <div class="card graphique-principale">
          <div>
              <button id="btnObjectifs">Voir Objectifs</button>
              <button id="btnDettes">Voir Dettes</button>
          </div>
        <canvas id="graphique-principale"></canvas>
      </div>

        <!-- list des graphiques pour le suivi des objectifs spécifiques-->
        <div class="colonne-cards">
            <div class="card list-graphiques">
        <h2>Objectifs</h2>
                <div>
        <button><div class="graphique-objectif-dette"><img src="{% static 'images/chart-icon.png' %}" alt="Mon icône" width="32" height="32"><div>Achat maison</div></div></button>
        <button><div class="graphique-objectif-dette"><img src="{% static 'images/chart-icon.png' %}" alt="Mon icône" width="32" height="32"><div>Investissement</div></div></button>
        <button><div class="graphique-objectif-dette"><img src="{% static 'images/chart-icon.png' %}" alt="Mon icône" width="32" height="32"><div>Épargne</div></div></button></div>
                <div>
                    <button> Ajouter objectif</button>
                </div>
            </div>
            <div class="séparateur-verticale"></div>

            <!-- list des graphiques pour le suivi des dettes spécifiques-->
            <div class="card list-graphiques">
        <h2>Dettes</h2>
                <div>
        <button><div class="graphique-objectif-dette"><img src="{% static 'images/chart-icon.png' %}" alt="Mon icône" width="32" height="32"><div>Dette credit</div></div></button>
        <button><div class="graphique-objectif-dette"><img src="{% static 'images/chart-icon.png' %}" alt="Mon icône" width="32" height="32"><div>Dette étudiant</div></div></button>
        <button><div class="graphique-objectif-dette"><img src="{% static 'images/chart-icon.png' %}" alt="Mon icône" width="32" height="32"><div>Dette automobile</div></div></button>
                </div>
                <div>
                    <button>Ajouter dette</button>
                </div>
            </div>
        </div>
    </div>

  </div>

  <!-- javascript des graphiques-->
  <script>
      // générateurs de valeurs aléatoires
    function randomData(n) { return Array.from({ length: n }, () => Math.floor(Math.random() * 100) + 1); }
      //Dates pour l'axe des x des mini-graphiques
    const datesEntree = ['Mon','Tue','Wed','Thu','Fri','Sat','Sun'];

    //mini-graphique des revenus
    chartRevenues = new Chart(document.getElementById('chartRevenues').getContext('2d'), {
        type: 'line',
        data: { labels: datesEntree, datasets: [
            { label: 'Revenues',
                data: randomData(datesEntree.length),
                borderColor: 'hotpink',
                backgroundColor: 'rgba(255,105,180,0.2)',
                fill: true, tension: 0.3 }] },
        options: { responsive: false,
            scales:
                { x: { display: true },
                    y: { display: true, beginAtZero: true }}
            , plugins: { legend: { display: false } } }
      });

    //mini-graphique du capital de l'utlisateur
    chartCapital = new Chart(document.getElementById('chartValeurNette').getContext('2d'), {
        type: 'line',
        data: { labels: datesEntree, datasets: [
            { label: 'Valeur Nette',
                data: randomData(datesEntree.length),
                borderColor: 'hotpink',
                backgroundColor: 'rgba(255,105,180,0.2)',
                fill: true, tension: 0.3 }] },
        options: { responsive: false, scales: { x: { display: true }, y: { display: true, beginAtZero: true } }, plugins: { legend: { display: false } } }
      });

    // Mini-graphique des dépenses de l'utilisateur
    chartDepenses = new Chart(document.getElementById('chartDepenses').getContext('2d'), {
        type: 'line',
        data: { labels: datesEntree, datasets: [
            { label: 'Dépenses',
                data: randomData(datesEntree.length),
                borderColor: 'hotpink',
                backgroundColor: 'rgba(255,105,180,0.2)',
                fill: true, tension: 0.3 }] },
        options: { responsive: false,
            scales: { x: { display: true }, y: { display: true, beginAtZero: true } },
            plugins: { legend: { display: false } } }
      });

    // Graphique des objectifs et des dettes
    const randomSeries = (min,max) =>
      Array.from({length: labels.length}, () => +(Math.random()*(max-min)+min).toFixed(2));
    const objectifsData = randomData(datesEntree.length)
    const dettesData = randomData(datesEntree.length);

    const chartObjectifsDettes = new Chart(document.getElementById('lineChart').getContext('2d'), {
      type: 'line',
        data: { labels: datesEntree,
            datasets: [{
          label: 'Progression Objectifs',
                data: objectifsData,
                backgroundColor: 'rgba(255,105,180,0.2)',
                borderColor: 'hotpink',
                borderWidth: 1,
                fill: true,
                tension: 0.1 }] },
      options:
          { responsive: false, scales: { y: { beginAtZero: true } } }
    });

    // Configuration du changement entre le graphique des dettes et le graphique des objectifs

    document.getElementById('btnObjectifs').addEventListener('click', () => {
      chartObjectifsDettes.data.datasets[0].data = objectifsData;
      chartObjectifsDettes.data.datasets[0].label = 'Progression Objectifs';
      chartObjectifsDettes.update();
    });

    document.getElementById('btnDettes').addEventListener('click', () => {
      chartObjectifsDettes.data.datasets[0].data = dettesData;
      chartObjectifsDettes.data.datasets[0].label = 'Dettes';
      chartObjectifsDettes.update();
    });
  </script>


<script src="{% static 'js/tableau-bord.js' %}"></script>
</body>
</html>
