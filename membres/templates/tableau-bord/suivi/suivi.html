{% extends 'tableau-bord/master.html' %}
{% load static %}
{% block head %}
<head>
    <meta charset="UTF-8">
    <title>Suivi</title>

    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet"> <!-- Importation de la police Poppins -->
    <link rel="stylesheet" href="{% static 'css/tableau-bord/dashboard.css' %}">
    <link rel="stylesheet" href="{% static 'css/tableau-bord/suivi.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="icon" href="{% static 'images/Logo EcoNova.png' %}">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bodymovin/5.12.2/lottie.min.js"></script>
    <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
    <link rel="icon" href="{% static 'images/Logo EcoNova.png' %}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

</head>
{% endblock %}

{% block content %}
<!--Section suivi financier-->
    <div class="corp">
        <nav>
            <h1> Suivi Financier </h1>
        </nav>

        <div class="suivi-sections">
            <div class="actifs">
                <h2 class="sous-titre"> ACTIFS </h2>
                <label>
                    <h4 class="sous-sous-titre"> Comptes Chèque </h4>
                    <input class="actif" type="text" name="compte-cheque" placeholder="">
                </label>

                <label>
                    <h4 class="sous-sous-titre"> Comptes Epargne </h4>
                    <input class="actif" type="text" name="compte-epargne" placeholder="">
                </label>

                <label>
                    <h4 class="sous-sous-titre"> Comptes Bourse </h4>
                    <input class="actif" type="text" name="compte-bourse" placeholder="">
                </label>

                <label>
                    <h4 class="sous-sous-titre"> Comptes Cryptomonnaie </h4>
                    <input class="actif" type="text" name="compte-crypto" placeholder="">
                </label>

                <label>
                    <h4 class="sous-sous-titre"> Tout Autre Bien De Valeur </h4>
                    <input class="actif" type="text" name="autre-biens" placeholder="">
                </label>

            </div>

            <div class="passifs">
                <h2 class="sous-titre"> PASSIFS </h2>

                <label>
                    <h4 class="sous-sous-titre"> Cartes de Crédit </h4>
                    <input class="passif" type="text" name="credits" placeholder="">
                </label>

                <label>
                    <h4 class="sous-sous-titre"> Emprunts </h4>
                    <input class="passif" type="text" name="emprunts" placeholder="">
                </label>

                <label>
                    <h4 class="sous-sous-titre"> Hypothèque </h4>
                    <input class="passif" type="text" name="immobilier" placeholder="">
                </label>

                <label>
                    <h4 class="sous-sous-titre"> Crédit Automobile </h4>
                    <input class="passif" type="text" name="automobile" placeholder="">
                </label>

                <label>
                    <h4 class="sous-sous-titre"> Autre Crédit </h4>
                    <input class="passif" type="text" name="autre-crédit" placeholder="">
                </label>
            </div>

            <div class="barre-separation"> </div>

            <div class="revenus">
                <h2 class="sous-titre"> Calcul de vos revenus </h2>


                <label>
                    <h4 class="sous-sous-titre" > Revenus d'emploi (ou actifs) </h4>
                    <input type="text" name="hebdo" id="hebdo" placeholder="">
                </label>

                <label>
                    <h4 class="sous-sous-titre" > Revenus d'entreprise (si appliquable) </h4>
                    <input type="text" name="entreprise" id="entreprise" placeholder="">
                </label>

                <label>
                    <h4 class="sous-sous-titre" > Revenu de placement (ex: dividendes) </h4>
                    <input type="text" name="placement" id="placement" placeholder="">
                </label>

                <label>
                    <h4 class="sous-sous-titre" > Revenus non récurrents (Héritage, Lotterie, etc) </h4>
                    <input type="text" name="paye-autre" id="payeAutre" placeholder="">
                </label>

                <div class="resultat-investissement">
                    <h3> <strong> Votre revenu est de : </strong> </h3>
                    <p id="revenuTotal"> 0 $ </p>
                </div>
            </div>
        </div>


    <div class="capital-section">
        <h2> <strong> Votre Capital : </strong> </h2>
        <p id="capital-valeur"> </p>
    </div>

    <div class="bas-de-page">
    </div>

    <div class="séparation-invest">
    </div>

    <div class="suggestion">

        <div class="suggestions-tout">

        <div class="entete">
            <h2 class="sous-titre">
                Vous êtes insatisfaits par votre capital? ou Vous voulez fructifier votre capital actuel?
            </h2>

            <h3 class="sous-sous-titre">
                Voici différents comptes à intérêts qui vous permettrons de faire de vos rêves une réalité !
            </h3>
        </div>

        <div class="suggestion-compte">



            <div class="info-compte">

                <div class="haut-compte"></div>

                <h4 class="sous-sous-titre"> WealthSimple </h4>

                <h4 class="sous-sous-sous-titre"> Description </h4>

                <h5 class="contenu-text"> Ce compte est idéal pour toute personne voulant
                    fructifier leur capital à l'abri des impôts
                    que ce soit avec un petit ou grand capital.
                </h5>

                <h4 class="sous-sous-sous-titre"> Avantages </h4>

                <h5 class="contenu-text">
                    L'avantage principal de ce compte est que les taux d'intérêts augmentent avec votre capital
                    et que votre argent est disponible en tout temps.
                </h5>

                <a href="https://www.wealthsimple.com/fr-ca/accounts/registered-savings" target="_blank">
                    <h5 class="contenu-text-lien"> cliquez pour vous diriger vers la page du compte </h5>
                </a>
            </div>

            <img class="img-compte" src="{% static 'images/Wealthsimple_2015_Icon.svg' %}" alt="Icon de WealthSimple">

        </div>

        </div>

        <div class="barre-separation-suggestion"></div>

        <div class="interets">
                <h2 class="sous-titre"> Suivi d'un investissement à taux d'intérêts composés </h2>


                <label>
                    <h4 class="sous-sous-titre" > Investissement Initial </h4>
                    <input type="text" name="investissement-initial" id="investInitial" placeholder="">
                </label>

                <label>
                    <h4 class="sous-sous-titre" > Placements Mensuels </h4>
                    <input type="text" name="placement-mensuel" id="versements" placeholder="">
                </label>

                <label>
                    <h4 class="sous-sous-titre" > Taux d'intérêts en % </h4>
                    <input type="text" name="taux-interet" id="interets" placeholder="">
                </label>

                <div class="type-interet">
                    <button id="mensuel"> Mensuel </button>
                    <button id="annuel"> Annuel </button>
                </div>

                <label>
                    <h4 class="sous-sous-titre" > Durée (Années) </h4>
                    <input type="text" name="duree" id="duree" placeholder="">
                </label>

                <div class="resultat-investissement">
                    <h3> <strong> Voici la valeur finale de votre investissement : </strong> </h3>
                    <p id="investissement-valeur"> 0 $</p>
                </div>
            </div>
    </div>



  </div>


<!--JavaScript du calcul du capital lorsqu'on appuie sur le bouton-->

<script>
document.addEventListener("DOMContentLoaded", function () {
    const actifs = document.querySelectorAll(".actif");
    const passifs = document.querySelectorAll(".passif");

    function calculer() {
        console.log("calculerCapital() a été appelée !"); //Pour savoir si la fonction est appelée

        let sommeActifs = 0;
        actifs.forEach(input => {
            sommeActifs += parseFloat(input.value) || 0;
        });

        let sommePassifs = 0;
        passifs.forEach(input => {
            sommePassifs += parseFloat(input.value) || 0;
        });

        let capital = sommeActifs - sommePassifs;

        document.getElementById("capital-valeur").textContent = capital.toLocaleString() + " $";
    }

    actifs.forEach(input => {
        input.addEventListener("input", calculer)
    });

    passifs.forEach(input => {
        input.addEventListener("input", calculer)
    });

    calculer()
});
</script>

<!--JavaScript de la selection des boutons mensuel ou annuel-->

<script>
document.addEventListener("DOMContentLoaded", function () {
    const mensuelBtn = document.getElementById("mensuel");
    const annuelBtn = document.getElementById("annuel");

    if (!mensuelBtn || !annuelBtn) {
        console.error("Les boutons 'mensuel' ou 'annuel' n'ont pas été trouvés dans le DOM.");
        return;
    }

    function selection(event) {
        console.log("Clic détecté sur :", event.target.id);
        mensuelBtn.classList.remove("selected");
        annuelBtn.classList.remove("selected");
        event.target.classList.add("selected");
    }

    mensuelBtn.addEventListener("click", selection);
    annuelBtn.addEventListener("click", selection);
});
</script>

<!--JavaScript du calcul des inérêts composés mensuel ou annuel-->
<script>
    document.addEventListener("DOMContentLoaded", function () {

        function calculerCapital() {

            const C0 = parseFloat(document.getElementById("investInitial").value) || 0;
            const V = parseFloat(document.getElementById("versements").value) || 0;
            const r = parseFloat(document.getElementById("interets").value) / 100 || 0;
            const t = parseFloat(document.getElementById("duree").value) || 0;

            console.log("C0 = " + C0 + " V = " + V + " r = " + r + " t = " + t);

            const estMensuel = document.getElementById("mensuel").classList.contains("selected");

            let capitalFinal = 0;

        if (estMensuel) {
            const n = 12;
            const capitalInitial = C0 * Math.pow(1 + (r / 12), n * t);
            const capitalVersements = V * ((Math.pow(1 + (r / 12), n * t) - 1) / (r / 12));
            capitalFinal = capitalInitial + capitalVersements;

        } else {
            const n = 12;
            const capitalInitial = C0 * Math.pow(1 + r, t);
            const capitalVersements = ((V * n * (Math.pow(1 + r, t) - 1)) / r);
            capitalFinal = capitalInitial + capitalVersements;
        }

      document.getElementById("investissement-valeur").textContent = capitalFinal.toFixed(2) + " $";
    }

        document.getElementById("investInitial").addEventListener("input", calculerCapital)

        document.getElementById("versements").addEventListener("input", calculerCapital)

        document.getElementById("interets").addEventListener("input", calculerCapital)

        document.getElementById("duree").addEventListener("input", calculerCapital)

        document.getElementById("mensuel").addEventListener("click", calculerCapital)

        document.getElementById("annuel").addEventListener("click", calculerCapital)

    })
</script>

<script>
    document.addEventListener("DOMContentLoaded", function () {

        function calculerCapital() {

            const hebdo = parseFloat(document.getElementById("hebdo").value) || 0;
            const entreprise = parseFloat(document.getElementById("entreprise").value) || 0;
            const placement = parseFloat(document.getElementById("placement").value) || 0;
            const autre = parseFloat(document.getElementById("payeAutre").value) || 0;

            console.log("hebdo = " + hebdo + " entreprise = " + entreprise + " placement = " + placement + " autre = " + autre);

            let revenu = 0;

        revenu = hebdo + entreprise + placement + autre;

        document.getElementById("revenuTotal").textContent = revenu.toFixed(2) + " $";

    }

        document.getElementById("hebdo").addEventListener("input", calculerCapital)

        document.getElementById("entreprise").addEventListener("input", calculerCapital)

        document.getElementById("placement").addEventListener("input", calculerCapital)

        document.getElementById("payeAutre").addEventListener("input", calculerCapital)

    })
</script>

{% endblock %}